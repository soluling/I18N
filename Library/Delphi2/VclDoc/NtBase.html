<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<title>Soluling's VCL Classes: NtBase</title>
<link rel="StyleSheet" type="text/css" href="pasdoc.css">
</head>
<body bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#800080" alink="#FF0000">
<h1 class="unit">Unit NtBase</h1>
<table class="sections wide_list">
<tr>
<td><a class="section"  href="#%40Description">Description</a></td><td>Uses</td><td><a class="section"  href="#%40Classes">Classes, Interfaces, Objects and Records</a></td><td>Functions and Procedures</td><td><a class="section"  href="#%40Types">Types</a></td><td><a class="section"  href="#%40Constants">Constants</a></td><td><a class="section"  href="#%40Variables">Variables</a></td></tr></table>
<a name="%40Description"></a><h2 class="description">Description</h2>
<p>
Implements resource and locale routines that are common to VCL and FMX.</p>
<p>


<p>The unit contains following classes: <a class="normal"  href="NtBase.TNtLanguage.html">TNtLanguage</a> and <a class="normal"  href="NtBase.TNtLanguages.html">TNtLanguages</a>. They are used to store information about resource DLL languages.

<p>In addition it contains routines that are grouped into three static classes: <a class="normal"  href="NtBase.TNtBase.html">TNtBase</a>, <a class="normal"  href="NtBase.TNtLocaleRegistry.html">TNtLocaleRegistry</a> and <a class="normal"  href="NtBase.TNtConvert.html">TNtConvert</a>.

<p><a class="normal"  href="NtBase.TNtBase.html#GetAvailable">TNtBase.GetAvailable</a> gets the available resource languages. Use it to populate the available language list in your user interface. After you have selected the language call <a class="normal"  href="NtTranslator.TNtTranslator.html#SetNew">TNtTranslator.SetNew</a> to turn on that language.

<p>See <i>Samples\Delphi\VCL\CustomSelect</i> or <i>Samples\Delphi\FMX\CustomSelect</i> samples to see how to use the unit.</p>
<a name="%40Uses"></a><h2 class="overview">Overview</h2>
<a name="%40Classes"></a><h3 class="cio">Classes, Interfaces, Objects and Records</h3>
<table class="classestable wide_list">
<tr class="listheader">
<th class="itemname">Name</th>
<th class="itemdesc">Description</th>
</tr>
<tr class="list">
<td class="itemname">Class&nbsp;<a class="bold"  href="NtBase.TNtLanguage.html"><code>TNtLanguage</code></a></td>
<td class="itemdesc">Contains infomation about resource DLL language.</td>
</tr>
<tr class="list2">
<td class="itemname">Class&nbsp;<a class="bold"  href="NtBase.TNtLanguages.html"><code>TNtLanguages</code></a></td>
<td class="itemdesc">List of resource DLL languages.</td>
</tr>
<tr class="list">
<td class="itemname">Class&nbsp;<a class="bold"  href="NtBase.TNtBase.html"><code>TNtBase</code></a></td>
<td class="itemdesc">Static class that contains localization routines.</td>
</tr>
<tr class="list2">
<td class="itemname">Class&nbsp;<a class="bold"  href="NtBase.TNtResources.html"><code>TNtResources</code></a></td>
<td class="itemdesc">Static class that contains resource routines.</td>
</tr>
<tr class="list">
<td class="itemname">Class&nbsp;<a class="bold"  href="NtBase.TNtLocaleRegistry.html"><code>TNtLocaleRegistry</code></a></td>
<td class="itemdesc">Static class that contains registry routines to manipulate locale override values.</td>
</tr>
<tr class="list2">
<td class="itemname">Class&nbsp;<a class="bold"  href="NtBase.TNtConvert.html"><code>TNtConvert</code></a></td>
<td class="itemdesc">Static class that contains routines to convert between Ansi and Unicode.</td>
</tr>
<tr class="list">
<td class="itemname">Class&nbsp;<a class="bold"  href="NtBase.TNtExtension.html"><code>TNtExtension</code></a></td>
<td class="itemdesc">Abstract extension class.</td>
</tr>
<tr class="list2">
<td class="itemname">Class&nbsp;<a class="bold"  href="NtBase.TNtExtensions.html"><code>TNtExtensions</code></a></td>
<td class="itemdesc">Class that stores installed extension.</td>
</tr>
</table>
<a name="%40Types"></a><h3 class="summary">Types</h3>
<table class="summary wide_list">
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#UnicodeString">UnicodeString</a></b> = WideString;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#RawByteString">RawByteString</a></b> = AnsiString;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#TNtDayOfWeek">TNtDayOfWeek</a></b> = (...);</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#TNtFirstWeekOfYear">TNtFirstWeekOfYear</a></b> = (...);</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#TNtLayout">TNtLayout</a></b> = (...);</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#TNtResourceOption">TNtResourceOption</a></b> = (...);</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#TNtResourceOptions">TNtResourceOptions</a></b> = set of <a   href="NtBase.html#TNtResourceOption">TNtResourceOption</a>;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#TExtractOption">TExtractOption</a></b> = (...);</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#TExtractOptions">TExtractOptions</a></b> = set of <a   href="NtBase.html#TExtractOption">TExtractOption</a>;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#TNtLanguageName">TNtLanguageName</a></b> = (...);</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#TLocaleSelect">TLocaleSelect</a></b> = (...);</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#TNtExtensionClass">TNtExtensionClass</a></b> = class of <a   href="NtBase.TNtExtension.html">TNtExtension</a>;</code></td>
</tr>
</table>
<a name="%40Constants"></a><h3 class="summary">Constants</h3>
<table class="summary wide_list">
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#APPLICATION_RESOURCE">APPLICATION_RESOURCE</a></b> = 'SOLULING';</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#APPLICATION_DIR">APPLICATION_DIR</a></b> = 'Soluling';</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#LOCALE_SEPARATOR">LOCALE_SEPARATOR</a></b> = '-';</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#LOCALE_ALL">LOCALE_ALL</a></b> = 0;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#VCL_FORM_HEADER">VCL_FORM_HEADER</a></b>: array[0..3] of Byte = ($54, $50, $46, $30);</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#CSIDL_PERSONAL">CSIDL_PERSONAL</a></b> = $0005;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#SUBLANG_NEUTRAL">SUBLANG_NEUTRAL</a></b> = 0;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#LOCALE_OVERRIDE_KEY">LOCALE_OVERRIDE_KEY</a></b> = 'Software\Embarcadero\Locales';</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#OLD_LOCALE_OVERRIDE_KEY">OLD_LOCALE_OVERRIDE_KEY</a></b> = 'Software\CodeGear\Locales';</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#OLDEST_LOCALE_OVERRIDE_KEY">OLDEST_LOCALE_OVERRIDE_KEY</a></b> = 'Software\Borland\Locales';</code></td>
</tr>
</table>
<a name="%40Variables"></a><h3 class="summary">Variables</h3>
<table class="summary wide_list">
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#ResourceDllDir">ResourceDllDir</a></b>: String;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#LoadedResourceLocale">LoadedResourceLocale</a></b>: String;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#PreviouslyLoadedResourceLocale">PreviouslyLoadedResourceLocale</a></b>: String;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#ResourceOptions">ResourceOptions</a></b>: <a   href="NtBase.html#TNtResourceOptions">TNtResourceOptions</a>;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#FirstDayOfWeek">FirstDayOfWeek</a></b>: <a   href="NtBase.html#TNtDayOfWeek">TNtDayOfWeek</a>;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#FirstWeekOfYear">FirstWeekOfYear</a></b>: <a   href="NtBase.html#TNtFirstWeekOfYear">TNtFirstWeekOfYear</a>;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#UiLayout">UiLayout</a></b>: <a   href="NtBase.html#TNtLayout">TNtLayout</a>;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#OriginalLanguage">OriginalLanguage</a></b>: String;</code></td>
</tr>
<tr class="list">
<td class="itemcode"><code><b><a   href="NtBase.html#DefaultLocale">DefaultLocale</a></b>: String;</code></td>
</tr>
<tr class="list2">
<td class="itemcode"><code><b><a   href="NtBase.html#SystemLanguage">SystemLanguage</a></b>: String;</code></td>
</tr>
</table>
<h2 class="description">Description</h2>
<h3 class="detail">Types</h3>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="UnicodeString"></a><code><b>UnicodeString</b> = WideString;</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="RawByteString"></a><code><b>RawByteString</b> = AnsiString;</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TNtDayOfWeek"></a><code><b>TNtDayOfWeek</b> = (...);</code></td>
</tr>
<tr><td colspan="1">
<p>
Day of the week.</p>
<h6 class="description_section">Values</h6>
<ul>
<li>
wdMonday: Monday</li>
<li>
wdTuesday: Tuesday</li>
<li>
wdWednesday: Wednesday</li>
<li>
wdThursday: Thursday</li>
<li>
wdFriday: Friday</li>
<li>
wdSaturday: Saturday</li>
<li>
wdSunday: wdSunday</li>
</ul>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TNtFirstWeekOfYear"></a><code><b>TNtFirstWeekOfYear</b> = (...);</code></td>
</tr>
<tr><td colspan="1">
<p>
The first day of the week.</p>
<h6 class="description_section">Values</h6>
<ul>
<li>
fwFirstPart: First week that has at least one day in January.</li>
<li>
fwFirstFull: First full week of January.</li>
<li>
fwFirst4: First week that has at least four days in January.</li>
</ul>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TNtLayout"></a><code><b>TNtLayout</b> = (...);</code></td>
</tr>
<tr><td colspan="1">
<p>
User interface layout.</p>
<h6 class="description_section">Values</h6>
<ul>
<li>
laLeftToRight: User interface layout is Western (e.g. from left to right).</li>
<li>
laRightToLeft: User interface layout is Middle-Eastern (e.g. from right to left).</li>
</ul>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TNtResourceOption"></a><code><b>TNtResourceOption</b> = (...);</code></td>
</tr>
<tr><td colspan="1">
<p>
Specifies resource options.</p>
<h6 class="description_section">Values</h6>
<ul>
<li>
roNoThreadLocale: Do not update the thread locle.</li>
<li>
roNoLocaleVariables: Do not update the locale variables.</li>
<li>
roNoUpdateBidiMode: Do not update the TApplication.BiDiMode.</li>
<li>
roFlipChildren: Do not flip the controls on forms.</li>
<li>
roSaveLocale: Save the active locale.</li>
</ul>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TNtResourceOptions"></a><code><b>TNtResourceOptions</b> = set of <a   href="NtBase.html#TNtResourceOption">TNtResourceOption</a>;</code></td>
</tr>
<tr><td colspan="1">
<p>
Set of resource options.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TExtractOption"></a><code><b>TExtractOption</b> = (...);</code></td>
</tr>
<tr><td colspan="1">
<p>
Options for extrating embedded resource files.</p>
<h6 class="description_section">Values</h6>
<ul>
<li>
eoCheckDate: Application check the date of exisisting resource files (if any). If the date is same or newer as the embedded file the file is not extracted.</li>
<li>
eoRemoveFiles: Extracted files are removed after application closes.</li>
</ul>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TExtractOptions"></a><code><b>TExtractOptions</b> = set of <a   href="NtBase.html#TExtractOption">TExtractOption</a>;</code></td>
</tr>
<tr><td colspan="1">
<p>
Set of extracting options.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TNtLanguageName"></a><code><b>TNtLanguageName</b> = (...);</code></td>
</tr>
<tr><td colspan="1">
<p>
Specifies in what language language, country and locale names are given.</p>
<h6 class="description_section">Values</h6>
<ul>
<li>
lnNative: Language's own language is used: English, Deutsch, Français, ...</li>
<li>
lnLocalized: Language of the application is used.</li>
<li>
lnBoth: Native + localize is used.</li>
<li>
lnEnglish: English is used.</li>
<li>
lnSystem: Lanugage of the operation system is used.</li>
</ul>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TLocaleSelect"></a><code><b>TLocaleSelect</b> = (...);</code></td>
</tr>
<tr><td colspan="1">
<p>
Specifies how the default locale is selected.</p>
<h6 class="description_section">Values</h6>
<ul>
<li>
lsUI: Locale matching the UI language of OS. This is the default behaviour in Delphi 2010 or later.</li>
<li>
lsSettings: Locale matching the regional settings of Control Panel. This is the default behaviour in Delphi 2009 or earlier.</li>
</ul>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="TNtExtensionClass"></a><code><b>TNtExtensionClass</b> = class of <a   href="NtBase.TNtExtension.html">TNtExtension</a>;</code></td>
</tr>
<tr><td colspan="1">
<p>
Class type of the extension class.</p>
</td></tr>
</table>
<h3 class="detail">Constants</h3>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="APPLICATION_RESOURCE"></a><code><b>APPLICATION_RESOURCE</b> = 'SOLULING';</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="APPLICATION_DIR"></a><code><b>APPLICATION_DIR</b> = 'Soluling';</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="LOCALE_SEPARATOR"></a><code><b>LOCALE_SEPARATOR</b> = '-';</code></td>
</tr>
<tr><td colspan="1">
<p>
Character that is used to separate country part from language part in the locale id.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="LOCALE_ALL"></a><code><b>LOCALE_ALL</b> = 0;</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="VCL_FORM_HEADER"></a><code><b>VCL_FORM_HEADER</b>: array[0..3] of Byte = ($54, $50, $46, $30);</code></td>
</tr>
<tr><td colspan="1">
<p>
Form header.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="CSIDL_PERSONAL"></a><code><b>CSIDL_PERSONAL</b> = $0005;</code></td>
</tr>
<tr><td colspan="1">
<p>
The virtual folder that represents the My Documents desktop item.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="SUBLANG_NEUTRAL"></a><code><b>SUBLANG_NEUTRAL</b> = 0;</code></td>
</tr>
<tr><td colspan="1">
<p>
Neutral sub language id.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="LOCALE_OVERRIDE_KEY"></a><code><b>LOCALE_OVERRIDE_KEY</b> = 'Software\Embarcadero\Locales';</code></td>
</tr>
<tr><td colspan="1">
<p>
Current locale override key (Embarcadero era)</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="OLD_LOCALE_OVERRIDE_KEY"></a><code><b>OLD_LOCALE_OVERRIDE_KEY</b> = 'Software\CodeGear\Locales';</code></td>
</tr>
<tr><td colspan="1">
<p>
Old locale override key (CodeGear era)</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="OLDEST_LOCALE_OVERRIDE_KEY"></a><code><b>OLDEST_LOCALE_OVERRIDE_KEY</b> = 'Software\Borland\Locales';</code></td>
</tr>
<tr><td colspan="1">
<p>
Oldest locale override key (Borland era)</p>
</td></tr>
</table>
<h3 class="detail">Variables</h3>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ResourceDllDir"></a><code><b>ResourceDllDir</b>: String;</code></td>
</tr>
<tr><td colspan="1">
&nbsp;</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="LoadedResourceLocale"></a><code><b>LoadedResourceLocale</b>: String;</code></td>
</tr>
<tr><td colspan="1">
<p>
Currently loaded locale.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="PreviouslyLoadedResourceLocale"></a><code><b>PreviouslyLoadedResourceLocale</b>: String;</code></td>
</tr>
<tr><td colspan="1">
<p>
Previously loaded locale. If empty the current locale is the only locale that has been loaded.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="ResourceOptions"></a><code><b>ResourceOptions</b>: <a   href="NtBase.html#TNtResourceOptions">TNtResourceOptions</a>;</code></td>
</tr>
<tr><td colspan="1">
<p>
Resource options.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="FirstDayOfWeek"></a><code><b>FirstDayOfWeek</b>: <a   href="NtBase.html#TNtDayOfWeek">TNtDayOfWeek</a>;</code></td>
</tr>
<tr><td colspan="1">
<p>
Variable that stores the first day of the week of the current locale.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="FirstWeekOfYear"></a><code><b>FirstWeekOfYear</b>: <a   href="NtBase.html#TNtFirstWeekOfYear">TNtFirstWeekOfYear</a>;</code></td>
</tr>
<tr><td colspan="1">
<p>
Variable that stores the first week of the year of the current locale.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="UiLayout"></a><code><b>UiLayout</b>: <a   href="NtBase.html#TNtLayout">TNtLayout</a>;</code></td>
</tr>
<tr><td colspan="1">
<p>
Variable that stores current layout of the user interface.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="OriginalLanguage"></a><code><b>OriginalLanguage</b>: String;</code></td>
</tr>
<tr><td colspan="1">
<p>
Variable that stores the original language of the application.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="DefaultLocale"></a><code><b>DefaultLocale</b>: String;</code></td>
</tr>
<tr><td colspan="1">
<p>
Variable that stores the default language of the application.</p>
</td></tr>
</table>
<table class="detail wide_list">
<tr class="list">
<td class="itemcode"><a name="SystemLanguage"></a><code><b>SystemLanguage</b>: String;</code></td>
</tr>
<tr><td colspan="1">
<p>
Variable that stores the language of the operating system.</p>
</td></tr>
</table>
</body></html>
